<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>B1 & B2 English Tests</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.7.2/css/all.min.css" integrity="sha512-Evv84Mr4kqVGRNSgIGL/F/aIDqQb7xQ2vcrdIwxfjThSH8CSR7PBEakCr51Ck+w+/U6swU2Im1vVX0SVk9ABhg==" crossorigin="anonymous" referrerpolicy="no-referrer" />
  <link rel="icon" type="image/x-icon" href="favicon.ico">

  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 900px; margin: auto; background: #f9f9f9; }
    h2 { text-align: center; }
    .test-container { background: white; border-radius: 8px; padding: 20px; margin-bottom: 40px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);}
    fieldset { margin-bottom: 15px; }
    legend { font-weight: bold; margin-bottom: 6px; }
    label { display: block; margin: 5px 0; cursor: pointer; }
    button { padding: 10px 20px; font-size: 16px; cursor: pointer; border: none; border-radius: 5px; background-color: #007BFF; color: white; }
    button:hover { background-color: #0056b3; }
    #result { margin-top: 20px; font-weight: bold; white-space: pre-wrap; }
    .tabs { text-align: center; margin-bottom: 20px; }
    .tab-btn {
      cursor: pointer;
      display: inline-block;
      margin: 0 10px;
      padding: 10px 20px;
      border-radius: 5px;
      background-color: #ddd;
      font-weight: bold;
      user-select: none;
    }
    .tab-btn.active {
      background-color: #007BFF;
      color: white;
    }

    /* Form Container Styles (giris.html'den alındı) */
    .form-container {
      background-color: rgb(232, 192, 203);
      padding: 20px 25px;
      border-radius: 10px;
      box-shadow: 0 10px 25px rgba(0,0,0,0.2);
      width: 80%;
      max-width: 300px;
      margin: 20px auto; /* Ortalamak için */
      display: none; /* Varsayılan olarak gizli olacak */
    }

    .form-container h2 {
      text-align: center;
      margin-bottom: 4px;
    }

    .form-container input {
      width: 100%;
      padding: 8px;
      margin-bottom: 15px;
      border: 1px solid #ccc;
      border-radius: 5px;
      transition: border 0.3s;
      box-sizing: border-box; /* Padding'in genişliği etkilemesini engelle */
    }

    .form-container input:focus {
      border-color: #003366;
      outline: none;
    }

    .form-container button {
      width: 100%;
      padding: 12px;
      background-color: #003366;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
      cursor: pointer;
      transition: background 0.3s;
    }

    .form-container button:hover {
      background-color: #005f73;
    }

    .form-container p {
      text-align: center;
      margin-top: 15px;
    }
    .form-container a {
      color: #003366;
      text-decoration: none;
    }
    .form-container a:hover {
      text-decoration: underline;
    }

    /* Sayfa yüklendiğinde test içeriğini gizle, formları göster veya tersi */
    #test-content {
      display: none; /* Varsayılan olarak test içeriğini gizle */
    }
    #auth-section {
      text-align: center;
      margin-top: 50px;
    }
    #auth-section h2 {
      color: #333;
      margin-bottom: 15px;
    }
  </style>
</head>
<body>

  <header class="header">
      <a href="index.html" style="text-decoration: none; color: black; font-weight: bold;">Anasayfa</a>
  </header>

  <div id="auth-section">
    <h2>İngilizce Testlerine Erişmek İçin Lütfen Giriş Yapın veya Kayıt Olun</h2>

    <div class="form-container" id="register-form">
      <h2>Kayıt Ol</h2>
      <form id="registerForm">
        <input type="text" id="fullname" placeholder="Ad Soyad" required>
        <input type="email" id="email" placeholder="E-posta" required>
        <input type="number" id="telefon" placeholder="Telefon" required>
        <input type="password" id="password" placeholder="Şifre" required>
        <button type="submit">Kayıt Ol</button>
      </form>
      <p>Zaten üye misiniz? <a href="#" id="show-login">Giriş yap</a></p>
    </div>

    <div class="form-container" id="login-form">
      <h2>Giriş Yap</h2>
      <form id="loginForm">
        <input type="email" id="login-email" placeholder="E-posta" required>
        <input type="password" id="login-password" placeholder="Şifre" required>
        <button type="submit">Giriş Yap</button>
      </form>
      <p>Hesabınız yok mu? <a href="#" id="show-register">Kayıt ol</a></p>
    </div>
  </div>


  <div id="test-content">
    <h2>İngilizce Testleri</h2>

    <div class="tabs">
      <span class="tab-btn active" id="btnB1">B1 Test</span>
      <span class="tab-btn" id="btnB2">B2 Test</span>
    </div>

    <div class="test-container" id="testB1">
      <form id="formB1">
        <fieldset>
          <legend>1. I _____ to the store yesterday.</legend>
          <label><input type="radio" name="q1" value="a"> A) go</label>
          <label><input type="radio" name="q1" value="b"> B) went</label>
          <label><input type="radio" name="q1" value="c"> C) gone</label>
        </fieldset>

        <fieldset>
          <legend>2. She usually _____ her homework after school.</legend>
          <label><input type="radio" name="q2" value="a"> A) do</label>
          <label><input type="radio" name="q2" value="b"> B) does</label>
          <label><input type="radio" name="q2" value="c"> C) did</label>
        </fieldset>

        <fieldset>
          <legend>3. They have been _____ since morning.</legend>
          <label><input type="radio" name="q3" value="a"> A) work</label>
          <label><input type="radio" name="q3" value="b"> B) working</label>
          <label><input type="radio" name="q3" value="c"> C) worked</label>
        </fieldset>

        <fieldset>
          <legend>4. We _____ dinner when the phone rang.</legend>
          <label><input type="radio" name="q4" value="a"> A) have</label>
          <label><input type="radio" name="q4" value="b"> B) were having</label>
          <label><input type="radio" name="q4" value="c"> C) had</label>
        </fieldset>

        <fieldset>
          <legend>5. If I _____ you, I would take the offer.</legend>
          <label><input type="radio" name="q5" value="a"> A) am</label>
          <label><input type="radio" name="q5" value="b"> B) were</label>
          <label><input type="radio" name="q5" value="c"> C) was</label>
        </fieldset>

        <fieldset>
          <legend>6. He _____ to work every day by bus.</legend>
          <label><input type="radio" name="q6" value="a"> A) goes</label>
          <label><input type="radio" name="q6" value="b"> B) go</label>
          <label><input type="radio" name="q6" value="c"> C) going</label>
        </fieldset>

        <fieldset>
          <legend>7. They _____ a new house last year.</legend>
          <label><input type="radio" name="q7" value="a"> A) bought</label>
          <label><input type="radio" name="q7" value="b"> B) buy</label>
          <label><input type="radio" name="q7" value="c"> C) buying</label>
        </fieldset>

        <fieldset>
          <legend>8. What time _____ the train leave?</legend>
          <label><input type="radio" name="q8" value="a"> A) do</label>
          <label><input type="radio" name="q8" value="b"> B) does</label>
          <label><input type="radio" name="q8" value="c"> C) did</label>
        </fieldset>

        <fieldset>
          <legend>9. I _____ never seen such a beautiful sunset.</legend>
          <label><input type="radio" name="q9" value="a"> A) have</label>
          <label><input type="radio" name="q9" value="b"> B) has</label>
          <label><input type="radio" name="q9" value="c"> C) had</label>
        </fieldset>

        <fieldset>
          <legend>10. She _____ to play the piano when she was a child.</legend>
          <label><input type="radio" name="q10" value="a"> A) learned</label>
          <label><input type="radio" name="q10" value="b"> B) learn</label>
          <label><input type="radio" name="q10" value="c"> C) learning</label>
        </fieldset>

        <fieldset>
          <legend>11. We _____ in London since 2010.</legend>
          <label><input type="radio" name="q11" value="a"> A) have lived</label>
          <label><input type="radio" name="q11" value="b"> B) lived</label>
          <label><input type="radio" name="q11" value="c"> C) living</label>
        </fieldset>

        <fieldset>
          <legend>12. I _____ to the gym twice a week.</legend>
          <label><input type="radio" name="q12" value="a"> A) go</label>
          <label><input type="radio" name="q12" value="b"> B) goes</label>
          <label><input type="radio" name="q12" value="c"> C) going</label>
        </fieldset>

        <fieldset>
          <legend>13. The movie was _____ interesting.</legend>
          <label><input type="radio" name="q13" value="a"> A) very</label>
          <label><input type="radio" name="q13" value="b"> B) much</label>
          <label><input type="radio" name="q13" value="c"> C) many</label>
        </fieldset>

        <fieldset>
          <legend>14. I _____ my homework before dinner.</legend>
          <label><input type="radio" name="q14" value="a"> A) finished</label>
          <label><input type="radio" name="q14" value="b"> B) finish</label>
          <label><input type="radio" name="q14" value="c"> C) finishing</label>
        </fieldset>

        <fieldset>
          <legend>15. They _____ to the party last weekend.</legend>
          <label><input type="radio" name="q15" value="a"> A) went</label>
          <label><input type="radio" name="q15" value="b"> B) go</label>
          <label><input type="radio" name="q15" value="c"> C) gone</label>
        </fieldset>

        <button type="button" onclick="checkAnswers('B1')">Sonuçları Gör (B1)</button>
      </form>
      <div id="resultB1"></div>
    </div>

    <div class="test-container" id="testB2" style="display:none;">
      <form id="formB2">
        <fieldset>
          <legend>1. Despite _____ tired, she continued working.</legend>
          <label><input type="radio" name="q1" value="a"> A) feeling</label>
          <label><input type="radio" name="q1" value="b"> B) feel</label>
          <label><input type="radio" name="q1" value="c"> C) felt</label>
        </fieldset>

        <fieldset>
          <legend>2. If I _____ you, I would accept the invitation.</legend>
          <label><input type="radio" name="q2" value="a"> A) were</label>
          <label><input type="radio" name="q2" value="b"> B) am</label>
          <label><input type="radio" name="q2" value="c"> C) was</label>
        </fieldset>

        <fieldset>
          <legend>3. She suggested _____ earlier to avoid traffic.</legend>
          <label><input type="radio" name="q3" value="a"> A) leaving</label>
          <label><input type="radio" name="q3" value="b"> B) leave</label>
          <label><input type="radio" name="q3" value="c"> C) left</label>
        </fieldset>

        <fieldset>
          <legend>4. They _____ to finish the project by Friday.</legend>
          <label><input type="radio" name="q4" value="a"> A) plan</label>
          <label><input type="radio" name="q4" value="b"> B) plans</label>
          <label><input type="radio" name="q4" value="c"> C) planned</label>
        </fieldset>

        <fieldset>
          <legend>5. By this time next year, I _____ graduated.</legend>
          <label><input type="radio" name="q5" value="a"> A) will have</label>
          <label><input type="radio" name="q5" value="b"> B) have</label>
          <label><input type="radio" name="q5" value="c"> C) will</label>
        </fieldset>

        <fieldset>
          <legend>6. He has been working here _____ 2015.</legend>
          <label><input type="radio" name="q6" value="a"> A) since</label>
          <label><input type="radio" name="q6" value="b"> B) for</label>
          <label><input type="radio" name="q6" value="c"> C) from</label>
        </fieldset>

        <fieldset>
          <legend>7. The book _____ by a famous author.</legend>
          <label><input type="radio" name="q7" value="a"> A) was written</label>
          <label><input type="radio" name="q7" value="b"> B) wrote</label>
          <label><input type="radio" name="q7" value="c"> C) written</label>
        </fieldset>

        <fieldset>
          <legend>8. I wish I _____ more time to travel.</legend>
          <label><input type="radio" name="q8" value="a"> A) have</label>
          <label><input type="radio" name="q8" value="b"> B) had</label>
          <label><input type="radio" name="q8" value="c"> C) will have</label>
        </fieldset>

        <fieldset>
          <legend>9. They _____ going to the party tonight.</legend>
          <label><input type="radio" name="q9" value="a"> A) are</label>
          <label><input type="radio" name="q9" value="b"> B) is</label>
          <label><input type="radio" name="q9" value="c"> C) was</label>
        </fieldset>

        <fieldset>
          <legend>10. We _____ never seen such a movie before.</legend>
          <label><input type="radio" name="q10" value="a"> A) have</label>
          <label><input type="radio" name="q10" value="b"> B) has</label>
          <label><input type="radio" name="q10" value="c"> C) had</label>
        </fieldset>

        <fieldset>
          <legend>11. If he _____ earlier, he wouldn’t have missed the train.</legend>
          <label><input type="radio" name="q11" value="a"> A) had left</label>
          <label><input type="radio" name="q11" value="b"> B) has left</label>
          <label><input type="radio" name="q11" value="c"> C) left</label>
        </fieldset>

        <fieldset>
          <legend>12. This time next week, I _____ on vacation.</legend>
          <label><input type="radio" name="q12" value="a"> A) will be</label>
          <label><input type="radio" name="q12" value="b"> B) am</label>
          <label><input type="radio" name="q12" value="c"> C) was</label>
        </fieldset>

        <fieldset>
          <legend>13. She _____ to improve her English skills.</legend>
          <label><input type="radio" name="q13" value="a"> A) tries</label>
          <label><input type="radio" name="q13" value="b"> B) try</label>
          <label><input type="radio" name="q13" value="c"> C) trying</label>
        </fieldset>

        <fieldset>
          <legend>14. We _____ already finished our homework.</legend>
          <label><input type="radio" name="q14" value="a"> A) have</label>
          <label><input type="radio" name="q14" value="b"> B) has</label>
          <label><input type="radio" name="q14" value="c"> C) had</label>
        </fieldset>

        <fieldset>
          <legend>15. They _____ gone to the store before it started raining.</legend>
          <label><input type="radio" name="q15" value="a"> A) had</label>
          <label><input type="radio" name="q15" value="b"> B) has</label>
          <label><input type="radio" name="q15" value="c"> C) have</label>
        </fieldset>

        <button type="button" onclick="checkAnswers('B2')">Sonuçları Gör (B2)</button>
      </form>
      <div id="resultB2"></div>
    </div>
    <br>
    <a href="index.html"> Anasayfaya dön</a>
  </div> <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-auth.js";
    import { getFirestore, setDoc, doc, getDoc } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyA26XLG7jdLhyZ6HyzhuapXON-kCn0jNd4", // Kendi Firebase API anahtarınız
      authDomain: "learnenglish-b0777.firebaseapp.com",
      projectId: "learnenglish-b0777",
      storageBucket: "learnenglish-b0777.appspot.com",
      messagingSenderId: "547469954131",
      appId: "1:547469954131:web:1869e9a6c702bffad04aa6",
      measurementId: "G-6F3C3SXK32"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // HTML elementlerini al
    const authSection = document.getElementById('auth-section'); // Yeni eklenen kısım
    const registerFormContainer = document.getElementById('register-form');
    const loginFormContainer = document.getElementById('login-form');
    const testContent = document.getElementById('test-content');

    // Oturum durumuna göre formları veya testi göster
    onAuthStateChanged(auth, async (user) => {
      if (user) {
        // Kullanıcı giriş yapmışsa
        const userDocRef = doc(db, "users", user.uid);
        const userDocSnap = await getDoc(userDocRef);

        if (userDocSnap.exists() && userDocSnap.data().isAdmin) {
          // Admin ise admin sayfasına yönlendir
          window.location.href = "admin.html";
        } else {
          // Admin değilse veya belge bulunamazsa, test içeriğini göster
          authSection.style.display = 'none'; // Yetkilendirme bölümünü gizle
          testContent.style.display = 'block';
        }
      } else {
        // Kullanıcı giriş yapmamışsa: Giriş/Kayıt formlarını göster
        authSection.style.display = 'block'; // Yetkilendirme bölümünü göster
        registerFormContainer.style.display = 'block'; // Başlangıçta kayıt formunu göster
        loginFormContainer.style.display = 'none';
        testContent.style.display = 'none';
      }
    });

    // Formlar arası geçiş
    document.getElementById("show-login").addEventListener("click", (e) => {
      e.preventDefault();
      registerFormContainer.style.display = "none";
      loginFormContainer.style.display = "block";
    });

    document.getElementById("show-register").addEventListener("click", (e) => {
      e.preventDefault();
      loginFormContainer.style.display = "none";
      registerFormContainer.style.display = "block";
    });

    // Kayıt Formu Gönderme
    document.getElementById("registerForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const fullname = document.getElementById("fullname").value.trim();
      const email = document.getElementById("email").value.trim();
      const telefon = document.getElementById("telefon").value.trim();
      const password = document.getElementById("password").value;

      try {
        const userCredential = await createUserWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;

        await setDoc(doc(db, "users", user.uid), {
          ad: fullname.split(" ")[0] || fullname,
          soyad: fullname.split(" ")[1] || "",
          email: email,
          telefon: telefon,
          isAdmin: false // Yeni kayıt olan kullanıcılara varsayılan olarak admin yetkisi verilmedi.
        });

        alert("Kayıt başarılı! Giriş yaptınız ve teste erişebilirsiniz.");
        // Başarılı kayıttan sonra testi göster
        authSection.style.display = 'none';
        testContent.style.display = 'block';

      } catch (error) {
        alert("Kayıt hatası: " + error.message);
      }
    });

    // Giriş Formu Gönderme
    document.getElementById("loginForm").addEventListener("submit", async (e) => {
      e.preventDefault();
      const email = document.getElementById("login-email").value.trim();
      const password = document.getElementById("login-password").value;

      try {
        const userCredential = await signInWithEmailAndPassword(auth, email, password);
        const user = userCredential.user;

        const userDocRef = doc(db, "users", user.uid);
        const userDocSnap = await getDoc(userDocRef);

        if (userDocSnap.exists()) {
          const userData = userDocSnap.data();
          if (userData.isAdmin) {
            alert("Giriş başarılı. Admin sayfasına yönlendiriliyorsun!");
            window.location.href = "admin.html";
          } else {
            alert("Giriş başarılı. Teste erişebilirsiniz.");
            // Admin olmayanlar için testi göster
            authSection.style.display = 'none';
            testContent.style.display = 'block';
          }
        } else {
          // Kullanıcı belgesi bulunamazsa (nadiren olur, ama hata yönetimi için)
          alert("Giriş başarılı, ancak kullanıcı bilgileri bulunamadı. Teste erişebilirsiniz.");
          testContent.style.display = 'block';
          authSection.style.display = 'none';
        }
      } catch (error) {
        alert("Giriş hatası: " + error.message);
      }
    });

  </script>

  <script>
    // Tab switcher (mevcut test JavaScript'iniz)
    const btnB1 = document.getElementById('btnB1');
    const btnB2 = document.getElementById('btnB2');
    const testB1 = document.getElementById('testB1');
    const testB2 = document.getElementById('testB2');
    const resultB1 = document.getElementById('resultB1');
    const resultB2 = document.getElementById('resultB2');

    btnB1.onclick = () => {
      testB1.style.display = 'block';
      testB2.style.display = 'none';
      btnB1.classList.add('active');
      btnB2.classList.remove('active');
      resultB1.innerHTML = '';
      resultB2.innerHTML = '';
    };

    btnB2.onclick = () => {
      testB1.style.display = 'none';
      testB2.style.display = 'block';
      btnB2.classList.add('active');
      btnB1.classList.remove('active');
      resultB1.innerHTML = '';
      resultB2.innerHTML = '';
    };

    function checkAnswers(level) {
      let correctAnswers, total, form, resultDiv;
      if(level === 'B1') {
        correctAnswers = {
          q1: 'b', q2: 'b', q3: 'b', q4: 'b', q5: 'b',
          q6: 'a', q7: 'a', q8: 'a', q9: 'a', q10: 'a',
          q11: 'a', q12: 'a', q13: 'a', q14: 'a', q15: 'a'
        };
        form = document.getElementById('formB1');
        resultDiv = resultB1;
      } else if(level === 'B2') {
        correctAnswers = {
          q1: 'a', q2: 'a', q3: 'a', q4: 'a', q5: 'a',
          q6: 'a', q7: 'a', q8: 'b', q9: 'a', q10: 'a',
          q11: 'a', q12: 'a', q13: 'a', q14: 'a', q15: 'a'
        };
        form = document.getElementById('formB2');
        resultDiv = resultB2;
      } else {
        return;
      }

      total = Object.keys(correctAnswers).length;
      let score = 0;
      let details = '';

      for (let q in correctAnswers) {
        const selected = form.querySelector(`input[name="${q}"]:checked`);
        if (selected && selected.value === correctAnswers[q]) {
          score++;
          details += `<p><strong>${q}.</strong> Doğru ✔️</p>`;
        } else {
          const correctOption = form.querySelector(`input[name="${q}"][value="${correctAnswers[q]}"]`);
          const correctLabel = correctOption ? correctOption.parentElement.textContent.trim() : 'Bilinmiyor';
          details += `<p><strong>${q}.</strong> Yanlış ❌ - Doğru cevap: <em>${correctLabel}</em></p>`;
        }
      }

      let message = `<p>Doğru cevap sayısı: ${score} / ${total}</p>`;
      resultDiv.innerHTML = message + '<hr>' + details;
    }
  </script>
</body>
</html>